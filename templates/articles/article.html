{% extends 'base.html' %}
{% load static %}
{% load markdown_template_tag %}

    {% block styles %}
    <link rel="stylesheet" href="{% static 'styles/article.css' %}">
    {% endblock %}

        {% block content %}

        <main>

            {% if article.deleted_at %}
                <h1 style="color: tomato">This article has been rejected!</h1>
            {% endif %}

            <div class="article-container">

                <div class="article-heading">
                    <h1 class="article-title">{{ article.title }}</h1>

                    <div class="mod-btns">

                        {% if edit_button %}
                            <a href="" class="btn-moderation">Edit Article</a>
                        {% endif %}
                        {% if approval_phase %}
                            <a href="{% url 'approve_article' article.pk %}" class="btn-moderation">Approve</a>
                            <a href="#" class="btn-moderation" id="reject-btn">Reject</a>
                            <div id="overlay" class="overlay">
                                <div class="popup" id="popup">
                                    <h1 id="close-btn">X</h1>
                                    <form method="post" action="{% url 'reject_article' article.pk %}" id="rejection-form">
                                        <h2>Enter a reason for rejection!</h2> 
                                        <textarea name="reason_for_rejection" id="reason-rejection"
                                        placeholder="Please give your reasons here..." required></textarea>
                                        <br>
                                        {% csrf_token %}
                                        <button type="submit" class="btn-moderation" id="submit-rejection">Reject Article!</button>
                                    </form>
                                </div>
                            </div>
                        {% endif %}
                    </div>
                </div>

                <div class="article-metadata">
                    <div class="author-profile-picture">
                        <img src="{% static 'images/default-profile-pic.jpg' %}" alt="Author's Profile Picture">
                    </div>
                    <span class="author-name">By <a href="{% url 'profile_details' author.pk %}">{{ author.user.username }}</a></span>
                    <span class="publish-date">Published on {{ article.created_at|date:"F j, Y" }}</span>
                </div>

                {% if article.picture %}
                <div class="article-image">
                    <img src="{{ article.picture.url }}" alt="Article cover photo">
                </div>
                {% else %}
                <div class="article-image">
                    <img src="{% static 'images/default-article-pic.jpg' %}" alt="Article cover photo">
                </div>
                {% endif %}

                <div class="article-content">
                    {{ article.content|MD }}
                </div>

                <div class="tags">
                    <h3>Tags:</h3>

                    {% for tag in tags %}
                        <span class="tag">{{ tag.name }}</span>
                    {% empty %}
                        <span class="tag">No tags listed</span>
                    {% endfor %}

                </div>

                {% if article.is_approved %}
                    <div class="article-reactions" id="reactions">
                        <a href="" class="reaction-btn liked">
                            üëç Like (32)
                        </a>
                        <a href="" class="reaction-btn disliked">
                            üëé Dislike (21)
                        </a>
                    </div>
                
                    <div class="comments-section">
                        <hr>
                        <h2>Comments:</h2>
                        {% if user.is_authenticated %}
                            <div class="comment-form">
                                <form action="{% url 'post_comment' article.pk %}" method="post">
                                    {% csrf_token %}
                                    <div>
                                        <textarea name="content" rows="3" placeholder="Write a comment..." required minlength="1" maxlength="500"></textarea>
                                    </div>
                                    <button type="submit" class="submit-comment-btn">Submit Comment</button>
                                </form>
                            </div>
                        {% else %}
                            <p class="sign-in-prompt">You need to <a href="{% url 'sign_in' %}" class="login-btn">Sign In</a> to comment.</p>
                        {% endif %}

                        <div class="comments-list" id="comments">

                            <div class="comment">
                                <div class="comment-user-info">
                                    <div class="comment-user-profile-picture">
                                        <img src="{% static 'images/default-profile-pic.jpg' %}" alt="User profile picture">
                                    </div>
                                    <a href="" class="comment-user-username">Usercommenter</a>
                                    <span class="comment-date">On 24/04/2005</span>
                                </div>
                                <p class="comment-content">
                                    Lorem ipsum, dolor sit amet consectetur adipisicing elit. 
                                    Quam qui dicta laudantium totam amet. Ipsa explicabo ad, 
                                    dicta facere fugiat numquam 
                                    dolorem amet incidunt veritatis, 
                                    animi distinctio maxime voluptates. Minima!
                                </p>
                                <div class="comment-actions">
                                    <a href="" 
                                    class="comment-like liked">
                                        üëç Like (21)
                                    </a>
                                    <a href="" 
                                    class="comment-dislike disliked">
                                        üëé Dislike (33)
                                    </a>
                                    <a href="" class="comment-edit" style="margin-left: auto;">Edit</a>
                                    <form action="" method="post">
                                        {% csrf_token %}
                                        <button>Delete Comment</button>
                                    </form>
                                </div>
                            </div>

                            <div class="comment">
                                <div class="comment-user-info">
                                    <div class="comment-user-profile-picture">
                                        <img src="{% static 'images/default-profile-pic.jpg' %}" alt="User profile picture">
                                    </div>
                                    <a href="" class="comment-user-username">Usercommenter</a>
                                    <span class="comment-date">On 24/04/2005</span>
                                </div>
                                <p class="comment-content">
                                    Lorem ipsum, dolor sit amet consectetur adipisicing elit. 
                                    Quam qui dicta laudantium totam amet. Ipsa explicabo ad, 
                                    dicta facere fugiat numquam 
                                    dolorem amet incidunt veritatis, 
                                    animi distinctio maxime voluptates. Minima!
                                </p>
                                <div class="comment-actions">
                                    <a href="" 
                                    class="comment-like liked">
                                        üëç Like (21)
                                    </a>
                                    <a href="" 
                                    class="comment-dislike">
                                        üëé Dislike (33)
                                    </a>
                                    <a href="" class="comment-edit" style="margin-left: auto;">Edit</a>
                                    <form action="" method="post"><button>Delete Comment</button></form>
                                </div>
                            </div>

                            <div class="comment">
                                <div class="comment-user-info">
                                    <div class="comment-user-profile-picture">
                                        <img src="{% static 'images/default-profile-pic.jpg' %}" alt="User profile picture">
                                    </div>
                                    <a href="" class="comment-user-username">Usercommenter</a>
                                    <span class="comment-date">On 24/04/2005</span>
                                </div>
                                <p class="comment-content">
                                    1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890
                                    1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890
                                    1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890
                                    1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890
                                    1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890
                                </p>
                                <div class="comment-actions">
                                    <a href="" 
                                    class="comment-like">
                                        üëç Like (21)
                                    </a>
                                    <a href="" 
                                    class="comment-dislike disliked">
                                        üëé Dislike (33)
                                    </a>
                                    <a href="" class="comment-edit" style="margin-left: auto;">Edit</a>
                                    <form action="" method="post"><button>Delete Comment</button></form>
                                </div>
                            </div>

                            <div class="comment">
                                <div class="comment-user-info">
                                    <div class="comment-user-profile-picture">
                                        <img src="{% static 'images/default-profile-pic.jpg' %}" alt="User profile picture">
                                    </div>
                                    <a href="" class="comment-user-username">Usercommenter</a>
                                    <span class="comment-date">On 24/04/2005</span>
                                </div>
                                <p class="comment-content">
                                    Lorem ipsum, dolor sit amet consectetur adipisicing elit. 
                                    Quam qui dicta laudantium totam amet. Ipsa explicabo ad, 
                                    dicta facere fugiat numquam 
                                    dolorem amet incidunt veritatis, 
                                    animi distinctio maxime voluptates. Minima!
                                </p>
                                <div class="comment-actions">
                                    <a href="" 
                                    class="comment-like">
                                        üëç Like (21)
                                    </a>
                                    <a href="" 
                                    class="comment-dislike">
                                        üëé Dislike (33)
                                    </a>
                                    <a href="" class="comment-edit" style="margin-left: auto;">Edit</a>
                                    <form action="" method="post"><button>Delete Comment</button></form>
                                </div>
                            </div>


                        </div>

                    </div>
                {% endif %}

            </div>

        </main>

        {% endblock %}

        {% if approval_phase %}
            {% block javascript %}
                <script type="text/javascript" src="{% static 'js/article-approval-phase.js' %}" defer></script>
            {% endblock %}
        {% endif %}